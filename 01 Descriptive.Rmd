---
title: "01 Descriptive"
author: "Colin Linke"
date: "2024-05-08"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r "loading data", echo=FALSE, include=FALSE}
source("Code Transformations.R")
```



The data used by Meda et al. was gathered by a longitudinal study of first year students at to colleges in the North East of the United States using the semester System. The students in the study were given a an identification number and self reported their grades over 4 Semester, the amount of alcoholic drinks consumed and the amount of time they consumed marijuana. The gathered metrics for substance use did not come with further information on the metrical amount consumed, type or way of consumption, however there was an additional variable which tracked the amount of times a student on average consumed alcohol in the past month. Due to the fact that the authors of Meda et al. did not look further into this variable in the entirety of their paper, I dropped it in the replication attempt as well. Students were also provided a way to provide an interval for each consumed substance, in which case the middle point of the interval was used in the aggregation to the average amount consumed per semester. 

In Mena et al. it is mentioned that the amount of times Marijuana was consumed was further classified into categories on a scale from 1 to 6, with 6 being the categories with the largest consumption. They've also stated that the substance use data was transformed using a logarithmic function, with the logarithmic being provided in the accessible data. By replicating the table on page 7 it becomes apparent that the base used in the logarithmic function is 10, however this leads to a contradiction in the supposed data generating process. The highest value in the provided MJ consumption data is 1.41, the required base to transform to the categorie 6 would be roughly 2.88. After visualizing the data (see below) it seems likely that solely the logarithmic value was used and a value of 25 was used as a cut of point for higher values. 

Additionally, additional metrics for each participating student were gathered, such as their age, Their SAT scores, including the scores their scored in each part of it, their Parental Socio Economic situation (Parental_SES), the Beck Depression Index (BDI), the students Gender (Sex), their smoking status (Fager4_binary), their Family History of for Alcoholism (FH_binary, with positive implying that such a history exists) and their State Traite Anxiety Score (STAI), with the Parental SES, BDI, and STAI being questionnaires resulting in scores, with a higher score implying a higher socio economic parental standing, higher likelihood of developing a depression and higher Anxiety levels respectively, while Sex, Family History for Alcoholism and smoking status being categorical values. These variables were gathered once for each Student at the begginning of the study 

A total of 1142 students participated over 4 semester with a 95 % possible participation rate. The authors followed this up grouping the substance usage into three clusters, with them being no to low alcohol usage / no to low marijuana usage, medium to high alcohol usage / no to low marijuana usage and medium to high alcohol usage / medium to high marijuana usage, which is explained further below. The following table serves as a direct replication of the table provided on page 7, aswell as an overview of the used data stratified by the clusters the students were placed into in Semester 1:

```{r "page 7 table replication", echo = FALSE}
variables.paper.page7table <- c("Age1stround", "SATMath", "SATVerbal", "SATWriting", "GPA", "Parental_SES", "STAI_SELF_Total", "BDI_SELF_Total", "Avg_Drinks_SEM1", "Avg_MJ_SEM1", "Sex", "Fager4_binary", "FH_binary") 
catvars.paper.page7table <- c("Sex", "Fager4_binary", "FH_binary")
paper.page7table <- CreateTableOne(data = (data.file.long %>% filter(Semester == 1)), vars = variables.paper.page7table, catvars.paper.page7table, strata = "Cluster_SEM1", includeNA = TRUE, test = TRUE)

## tableone only uses ChisqTests. ContV --> bins --> discrete --> ChisqT
```


```{r page7table displayed}
paper.page7table
```

Both tables are generally identical, with the sole exception that for the Continuous Variables I used a Chi Squared Test, which discretizises the data and is therefor an approximation, unlike Mena et al. which uses an ANOVA test to directly compare the groups. Due to the large sample size there are only very minor differences and both have qualitative equal results, with all but Age, the SAT Sections on Verbal skills and Family History of Alcoholism having significant differences between the stratified clustered. (footnote, testing if the substance usage significantly differ between the clusters is somewhat trivial and self proofing, as the clusters were directly created by clustering on alcohol and marijuana usage.)

There are also minor differences in the Mean and standard deviation, this can mostly down to algorithmic alculation or rounding of these values with the exceptions to the GPA and SAT Section. In the provided data there were multiple instances in which these variables have entries of `0`. In the case of the GPA this could for example be due to the fact that students are dropping out, or that they these are missing values. These cases can be seen here 


```{r "GPA and SAT = 0", echo = FALSE}
plot.gpa0 <- ggplot(ind.gpa0, aes(x = Semester, y = GPA, group = BARCS_ID, col = BARCS_ID)) + 
  geom_line(alpha = .5)+ theme_bw() + ggtitle("GPA over all Semester for Studens with atleast one GPA =0")
```
```{r}
plot.gpa0 + theme(legend.position="none") 
ggplot(ind.sat0, aes(y = SATTotal, x = GPA)) + geom_point() + theme_bw()+ ggtitle("SAT overall score & GPA for Studens with atleast one SAT =0")
dim(ind.sat0 %>% filter(GPA == 0))
```

Considering that students usually have non zero GPA data points before and after they are assinged a value of '0',  it seems likely that a lot students were wrongly assigned '0' for NAs here. Additionally, a completed SAT can not have a point total of zero. It is also extremely likely '0' entries here are missing data, as most students also have a nonzero GPA, therefor implying that these are actually atten. Zero entries were subsequently imputed as NAs to avoid introducing bias into later estimates. There were a total of twelve observations with double entries of zeroes for the SAT and the GPA 

All other provided data was taken as it was given and assumed to be true. It is generally not observable if the data is wrong or not and further adjusting it may introduce bias through wrong assumptions.

The following plots show the the composition of the three different cluster given the alcohol and marijuana consumption choices. The first plot is a direct replication of the plot on the bottom of page 5, while the second plot represent the cluster alocation given the untransformed alcohol and marijuana consumptions. In the third plot, the untransformed variables are shown, however only values up to on average 12 monthly consumed alcoholic beverages & 10 times average MJ consumptions are being displayed in order for the separation between cluster 1 and 2 to become  more visible apparent.
```{r "page 5 replication", echo = FALSE}
data.file.long <- data.file.long %>% mutate(Cluster_current = as.factor(Cluster_current),
                                  BARCS_ID = as.factor(BARCS_ID))
cluster.colors <- c('1st.cluster' = "blue", '2nd.cluster' = "green", '3rd.cluster' = "red")
cluster.title <- "Cluster"
plot.page5 <- ggplot(data.file.long, 
                     aes(x = LOG_Avg_MJ_current, y = LOG_Avg_Drinks_current, col = Cluster_current)) + 
  geom_point() +
  xlab("Average Monthly MJ / Cannabis Use (Log10 Transformed)") +
  ylab("Average Number of Drinks per Month (Log10 Transformed)") +
  labs(colour = "cluster") +
  ggtitle("Cluster alocation given Alcohol & MJ consumption (log10 transformed)") +
  scale_colour_manual(values = cluster.colors, na.translate = FALSE) + theme_bw() +
  facet_wrap(~ Semester)


plot.page5.nottransformed <- ggplot(data.file.long, 
                     aes(x = Avg_MJ_current, y = Avg_Drinks_current, col = Cluster_current)) + 
  geom_point(alpha = 0.25) + #ylim(0, 50) +
  xlab("Average Monthly MJ / Cannabis Use (not transformed)") +
  ylab("Average Number of Drinks per Month (not transformed)") +
  labs(colour = "cluster") +
  ggtitle("Cluster alocation given Alcohol & MJ consumption") +
  scale_colour_manual(values = cluster.colors, na.translate = FALSE) + theme_bw() +
  facet_wrap(~ Semester)
  


plot.page5.nottransformed.focused <- ggplot(data.file.long, 
                     aes(x = Avg_MJ_current, y = Avg_Drinks_current, col = Cluster_current)) + 
  geom_point(alpha = 1) + ylim(0, 12) + xlim(0, 8) +
  xlab("Average Monthly MJ / Cannabis Use (not transformed)") +
  ylab("Average Number of Drinks per Month (not transformed)") +
  labs(colour = "cluster") +
  ggtitle("Showing the Separation") +
  scale_colour_manual(values = cluster.colors, na.translate = FALSE) + theme_bw() +
  facet_wrap(~ as.factor(Semester))
  
#cowplot::plot_grid(plot.page5, plot.page5.nottransformed, nrow = 2) ##just not good
```
```{r}
suppressWarnings(print(plot.page5))  
suppressWarnings(print(plot.page5.nottransformed)) 
suppressWarnings(print(plot.page5.nottransformed.focused)) 
```

The first plot is a direct replication of the shown graphic on page 5 of Mena et al. Here they show the relationship between the consumption use and the assigned Cluster in each of the 4 semester for each student. Mena et al. used a two step clustering algorithm, an initially hierarchically ordering the substance usage, which was then used to create various cluster, from which the cluster structure with the smallest AIC score was chosen. The cluster are time varying and based on the AIC there wasn't an additional 4th cluster constructed to differentiate between No-low MJ usage and medium - high MJ usage for medium - high alcoholic usage. The reported kappa statistic for the interreliaby cluster coherence between subsequent semester to the first are 
```{r}
Sem1_to <- c("Sem 2", "Sem 3", "Sem 4")
kappa_value <- c(0.64, 0.70, 0.67)
t(data.frame(Sem1_to, kappa_value))
```
with reported p value of < 0.001, which suggest substantial agreement of cluster assignment over time. 

These cluster assignments are taken as they were given by the authors of the paper, though this approach has a few short comings. Firstly, the clustering methods applied are not robust, different starting points can lead to different cluster assignments. Due to scarce information in Mena et al. it is unclear if additional steps were taking for a more robust cluster assignment. Secondly, the fact that the cluster assignment is time varying can make sense from the statistical perspective, however this means that students with identical substance usage across all semesters can be assigned to different clusters in the different semesters. Later interpretation of cluster parameters in regressions should therefor only be between Cluster assignment within a semester. In addition Mena et al. investigate effect the effect group transitions have on GPA, with group transition being used as a stand in for a significant change in substance usage. This approach can lead skewed results as minor consumption changes can lead to a new cluster assignment for some students, while for others much major significant change is required, yet both would be counted the same. Thirdly, transforming two variables into a single factor offers the benefit of mitigating the impact of outliers, which is later shown to be warranted, and simplifies the analysis and interpretation, this leads to a loss in information. There is also not a risk of multicolinearity, as the correlation between the two variables is only moderately high at 0.41 (footnote 0.47 for the log transformed data).
```{r, echo = FALSE}
cor(data.file.long$Avg_Drinks_current, data.file.long$Avg_MJ_current, use = "pairwise.complete.obs")
cor(data.file.long$LOG_Avg_Drinks_current, data.file.long$LOG_Avg_MJ_current, use = "pairwise.complete.obs")
```
Lastly, the field of statistics is an interdisciplinary field and using only statistical methods can come at the cost of interpreting the results and / or potentialy lack a real world context. It can be seen in the two untransformed plots above that the cutoff between Cluster 1 and Cluster 2 at roughly 3 alcoholic drinks per months, varying through the semester. The labeling of these clusters must be seen as a relative description between the clusters, but labeling the consumption of 5 alcoholic drinks per month as moderate alcohol usage is a subjective interpretations on the authors part. The cluster assignments could have also been based on, or partially based on previously established guidelines or research. The National Institue on Alcohol Abuse and Alcoholism for example defines heavy drinking as "consuming five or more drinks on any day or 15 or more per week [for men, or] consuming four or more on any day or 8 or more drinks per week [for women]", which would give an inherent interpretation of the cluster assignment. The NIAAA is also the same organisation which funded the study conducted by Mena et al. The usage of such guidelines can introduce another can of worms, given that the consumption of alcohol and Marijuana at the time of the study was illegal for the majority of the participating students and applying these guidelines has also an ethical aspect, it is understandable that the Authors decided to sidestep these concerns, however it is important to view these categories as a relative differences in the consumption behavior between the cluster in each semester.

```{r "NIAAA guideline source", echo = FALSE} 
#https://www.niaaa.nih.gov/alcohol-health/overview-alcohol-consumption/moderate-binge-drinking#:~:text=Heavy%20Alcohol%20Use%3A&text=For%20men%2C%20consuming%20five%20or,or%20more%20drinks%20per%20week 
``` 




```{r GPA - Alcohol visualisation, echo=FALSE}
plot.alcgpa <- ggplot(subset(subset(data.file.long, !is.na(Cluster_SEM1)) , sum.GPAna != 4), aes(x = Avg_Drinks_current, y = GPA, colour = Cluster_current)) +
  geom_point(alpha = 0.15) + #geom_smooth()  + ###to get a smooth fct for each cluster in every stratified plot
  geom_smooth(aes(group = 1), color = "black") +
  ylim(0, 4.5) + xlim(0, 125) + ylab("GPA in the given Semester") +
  xlab("Average Number of Drinks per Month (not transformed)") +
  labs(colour = "current Cluster") +
  ggtitle("Alcohol consumption & GPA given original Cluster specification") + scale_colour_manual(values = cluster.colors, na.translate = FALSE) + theme_bw() +
  facet_grid(Cluster_SEM1 ~ Semester, scales = "free")


plot.alcgpa.outliers <- ggplot(subset(subset(data.file.long, !is.na(Cluster_SEM1)) , sum.GPAna != 4), aes(x = Avg_Drinks_current, y = GPA, colour = Cluster_current)) +
  geom_point(alpha = 1)   +
  ylim(0, 4.5) + xlim(125, 350) + ylab("GPA in the given Semester") +
  xlab("Average Number of Drinks per Month (not transformed)") +
  labs(colour = "current Cluster") +
  ggtitle("Alcohol consumption & GPA given original Cluster specification") + scale_colour_manual(values = cluster.colors, na.translate = FALSE) + theme_bw() +
  facet_grid(Cluster_SEM1 ~ Semester, scales = "free")


plot.alcoholGPA <- ggplot(data = data.file.long, aes(x=Avg_Drinks_current, y=GPA)) +
  geom_point(alpha = 0.15) + geom_smooth() + ylim(0, 4.5) + facet_wrap(~Semester) +
  labs(x="Alcohol consumption per month during Semester" , y="GPA") + xlim(0, 150) + theme_bw()
```

```{r}
plot.alcgpa2<-  ggplot(data = data.file.long, aes(x=Avg_Drinks_current, y=GPA, colour = Cluster_current)) +
  geom_point(alpha = 0.15) + geom_smooth(aes(group = 1), color = "black") + ylim(0, 4.5) + xlim(0, 125) + facet_wrap(~Semester, scales = "free") +
  labs(x="Average Number of Drinks per Month (not transformed)" , y="GPA") + scale_colour_manual(values = cluster.colors, na.translate = FALSE) + theme_bw()

plot.alcgpa.outliers2<-  ggplot(data = data.file.long, aes(x=Avg_Drinks_current, y=GPA, colour = Cluster_current)) +
  geom_point(alpha = 0.15) + ylim(0, 4.5) + xlim(125,350) + facet_wrap(~Semester, scales = "free") +
  labs(x="Average Number of Drinks per Month (not transformed)" , y="GPA") + scale_colour_manual(values = cluster.colors, na.translate = FALSE) + theme_bw()
```
```{r}
suppressWarnings(print(plot.alcgpa2))
suppressWarnings(print(plot.alcgpa.outliers2))

```


Something that is missing in Mena et al. paper is a descriptive illustration of the substance usage compared to the GPA. The following two scatterplots show the average monthly alcoholic a student consumed each semester, stratified by the original cluster assignment in the first semester and are colored according to the given cluster assignment in each semester. The first graph showcases the majority of students with an added smooth function for each Cluster assignment and an alpha setting of 0.15 for the scatter points, while the second graph showcases outliers, namely student who consumed on average more than 125 alcoholic beverages in a given semester. Due to a lack of observation an additional smooth function was not included, nor was an alpha shading. 

```{r}
suppressWarnings(print(plot.alcgpa))
suppressWarnings(print(plot.alcgpa.outliers))
```

Generally, in each stratified plot there are very few observed students who have a GPA grade of less than one in almost every stratified plot. There were a total of 51 observation with an GPA of 1.00 or less across all Semesters and Clusters. It can also be seen that there are only few instances in which there was a transition from the first Cluster to the third Cluster or Vice Versa, the majority of transitions were between the second and first Cluster and the third and second Cluster. The decision of the Authors to define the Group transition as simply going from one cluster into another Cluster can therefor be substantiated as there aren't enough instances to make a valuable distinction. (footnote: there was an additional unused variable which tracked and differentiated Cluster transitions in the data set). 

The smooth curves for each 
The majority of observations are between 0-5 for Cluster 1, 0-40 for Cluster 2 & 0-100 for Cluster 3 over the Semester and the scantness of observation lead to a strong uncertainty in the smooth curve and should therefor be viewed sceptically. 




```{r, echo = FALSE, include=FALSE}
data.file.long %>% filter(Avg_Drinks_current > 150) %>% select(Cluster_SEM1, Cluster_current, Avg_Drinks_current, Avg_MJ_current, sum.GPAna, BARCS_ID) %>% group_by(BARCS_ID)

data.file.long %>% filter(Avg_Drinks_current > 125) %>% select(Cluster_SEM1, Cluster_current, Avg_Drinks_current, Avg_MJ_current, sum.GPAna, BARCS_ID) %>% group_by(BARCS_ID)

dim(data.file.long %>% filter(GPA <= 1.0))
```
There are a total of 79 & 48 observations with an average mothly consumption of 125 & 150 alcoholic drinks respectively. 


It is noteworthy that a lot of the observed Cluster 3 students are not observed anymore in the following semesters, but I'm going into the missing data further below. 



```{r}
suppressWarnings(print(plot.alcoholGPA))
```


THe following scatter plot is an illustration between the GPA and the MJ consumption. The plot is stratified by each Semester and an additional smooth function and an alpha shadding setting of 0.15. 

```{r}
plot.MJGPA<-  ggplot(data = data.file.long, aes(x=Avg_MJ_current, y=GPA, colour = Cluster_current)) +
  geom_point(alpha = 0.15) + geom_smooth(aes(group = 1), color = "black") + ylim(0, 4.5) + facet_wrap(~Semester, scales = "free") +
  labs(x="MJ consumption during Semester" , y="GPA") + scale_colour_manual(values = cluster.colors, na.translate = FALSE) + theme_bw()
```
```{r}
suppressWarnings(print(plot.MJGPA))
```
In each of the four semester there is a strong concentration in the intervall of zero to roughly four TAMJC and and smaller concentration at 25 TAMJC, as this is the highest possible value, effectively establishing a ceiling effect (footnote: is this a correct usage of the term?). There is also an almost linear separation in each of the four plots at roughly TAMJC = 4 between the different Clusters. There is a negative relation between increased Marijuana consumption and GPA with a mostly linear smooth effect across all semester, however due to the scant data between the two concentrations, this could simply reflect the rough arithmetic means of said cluster with a roughly linear trend between the two.  



Missing Data 
```{r}
table(data.file.long$sum.GPAna)
data.file.long %>% group_by(Semester) %>% summarise(MeanGPA = mean(GPA, na.rm = TRUE)) %>% 
  pivot_wider(names_from = Semester, values_from = MeanGPA, names_prefix = "Semester ")
data.file.long %>% group_by(Semester, sum.GPAna) %>% 
  summarise(MeanGPA = mean(GPA, na.rm = TRUE), .groups = 'drop') #%>% 
  # pivot_wider(names_from = c(Semester, sum.GPAna), values_from = MeanGPA, names_prefix = "Semester ", names_sep = "missing")
data.file.long %>% group_by(Semester, Cluster_SEM1) %>% 
  summarise(missing_GPA = sum(is.na(GPA)), .groups = 'drop') #%>%
  # pivot_wider(names_from = c(Semester, Cluster_SEM1), values_from = missing_GPA, names_prefix = "Semester ", names_sep = "missing")
```

censoring through dropout














APPENDEX.

It is noteworthy that the separation between Cluster 1 and 2 is around 3 monthly average alcohol beverages, though the hyperplane of the separation varies across the semester.   




```{r GPA variables}
gpa.spaghetti <- ggplot(data.file.long %>% filter(!is.na(Cluster_SEM1)), aes(x = Semester, y = GPA, group = BARCS_ID, col = Cluster_current)) +
  geom_point(alpha = 0.1) + 
  geom_line(alpha = 0.1) +
  xlab("Semester") + ylab("Grade Point Average") + labs(colour = "cluster") +
  ggtitle("GPA along original Cluster classification (1. Semester)") +
  facet_wrap(~Cluster_SEM1) + scale_colour_manual(values = cluster.colors, na.translate = FALSE) + theme_bw() 
gpa.spaghetti

gpa.spaghetti.diff <- ggplot(data.file.long %>% filter(!is.na(Cluster_SEM1)), aes(x = Semester, y = diff_GPA, group = BARCS_ID, col = Cluster_current)) +
  geom_point(alpha = 0.1) + 
  geom_line(alpha = 0.1) +
  xlab("Semester") + ylab("Change in GPA to previous Semester") + labs(colour = "cluster") +
  ggtitle("Different GPA along original Cluster classification (1. Semester)") +
  facet_wrap(~Cluster_SEM1) + scale_colour_manual(values = cluster.colors, na.translate = FALSE) + theme_bw() 
gpa.spaghetti.diff

gpa.spaghetti.mean <- ggplot(data.file.long %>% filter(!is.na(Cluster_SEM1)), aes(x = Semester, y = mean_GPA, group = BARCS_ID, col = Cluster_current)) +
  geom_point(alpha = 0.1) + 
  geom_line(alpha = 0.1) +
  xlab("Semester") + ylab("Grade Point Average, mean adjusted") + labs(colour = "cluster") +
  ggtitle("GPA along original Cluster classification (1. Semester) centered around mean") +
  facet_wrap(~Cluster_SEM1) + scale_colour_manual(values = cluster.colors, na.translate = FALSE) + theme_bw() 
gpa.spaghetti.mean

gpa.spaghetti.std <- ggplot(data.file.long %>% filter(!is.na(Cluster_SEM1)), aes(x = Semester, y = std_GPA, group = BARCS_ID, col = Cluster_current)) +
  geom_point(alpha = 0.1) + 
  geom_line(alpha = 0.1) +
  xlab("Semester") + ylab("Standardised Grade Point Average") + labs(colour = "cluster") +
  ggtitle("GPA along original Cluster classification (1. Semester), standardised") +
  facet_wrap(~Cluster_SEM1) + scale_colour_manual(values = cluster.colors, na.translate = FALSE) + theme_bw() 
gpa.spaghetti.std

plot.cluster.sem1.GPA <- ggplot(data = data.file.long, aes(x=as.factor(Semester), y=GPA)) +
  geom_boxplot(aes(fill=Cluster_SEM1)) + 
  xlab("Semester") + ylab("Grade Point Average") +
  ggtitle("GPA given 1. Sem Cluster") +
   scale_fill_manual(values = cluster.colors, na.translate = TRUE) + theme_bw() + guides(fill="none")
#plot.cluster.sem1.GPA

plot.cluster.current.GPA <- ggplot(data = data.file.long, aes(x = as.factor(Semester), y=GPA)) +
  geom_boxplot(aes(fill=Cluster_current)) + 
  xlab("Semester") + ylab("Grade Point Average") + guides(fill=guide_legend(title="Cluster")) +
  ggtitle("GPA given current Cluster") +
  scale_fill_manual(values = cluster.colors, na.translate = TRUE) + theme_bw() 
#plot.cluster.current.GPA

plot.cluster.sem1.GPA + plot.cluster.current.GPA
```


```{r "GPA interaction with Alcohol"}
plot.log.alcoholGPA <- ggplot(data = data.file.long, aes(x=LOG_Avg_Drinks_current, y=GPA)) +
  geom_point(alpha = 0.3) + geom_smooth() + ylim(0, 4.5) + facet_wrap(~Semester) +
  labs(x="Log10 Alcohol consumption per month during Semester" , y="GPA")
plot.log.alcoholGPA 

plot.alcoholGPA <- ggplot(data = data.file.long, aes(x=Avg_Drinks_current, y=GPA)) +
  geom_point(alpha = 0.3) + geom_smooth() + ylim(0, 4.5) + facet_wrap(~Semester) +
  labs(x="Alcohol consumption per month during Semester" , y="GPA") + xlim(0, 150)
plot.alcoholGPA 
```
Relationship appears to be nonlinear for log transformed Alcohol variable, and somewhat non linear for the transformed variable


```{r "GPA interaction with MJ"}
plot.log.MJGPA<-  ggplot(data = data.file.long, aes(x=LOG_Avg_MJ_current, y=GPA)) +
  geom_point(alpha = 0.3) + geom_smooth() + ylim(0, 4.5) + facet_wrap(~Semester, scales = "free") +
  labs(x=" log MJ consumption during Semester" , y="GPA")
plot.MJGPA<-  ggplot(data = data.file.long, aes(x=Avg_MJ_current, y=GPA)) +
  geom_point(alpha = 0.3) + geom_smooth() + ylim(0, 4.5) + facet_wrap(~Semester, scales = "free") +
  labs(x="MJ consumption during Semester" , y="GPA")
plot.log.MJGPA
plot.MJGPA
```
relationship seems to be mostly linear for both transformed and untransformed MJ usage 


```{r}

```

```{r}

```

```{r}

```












